# 道具获取系统改造总结

## 改造概述
将游戏中所有道具的获取方式从金币购买改为观看广告获取，完全移除金币消费机制，提升用户体验和广告收益。

## 修改的文件

### 1. gameViewCmpt.ts
**位置**: `/assets/script/game/ui/gameViewCmpt.ts`

**修改内容**:
- 修改 `onClickAddButton` 方法 (第1448-1482行)
- 将原来跳转到商店页面的逻辑改为直接观看广告获取道具

**修改前**: 点击加号按钮 → 跳转到商店页面 → 用金币购买
**修改后**: 点击加号按钮 → 观看15秒激励视频 → 直接获得对应道具

```typescript
// 新的道具获取逻辑
Advertise.showVideoAds((success: boolean) => {
    if (success) {
        GlobalFuncHelper.setBomb(type, 1);
        App.event.emit(EventName.Game.ToolCountRefresh);
        App.view.showMsgTips(`获得 ${toolName} x1！`);
    }
});
```

### 2. buyViewCmpt.ts  
**位置**: `/assets/script/game/ui/buyViewCmpt.ts`

**主要修改**:
1. **添加广告导入**: 导入 `Advertise` 类
2. **完全重写 `handleBtnEvent` 方法** (第58-143行):
   - 移除所有金币检查和扣费逻辑
   - 将所有购买按钮改为观看广告获取

3. **简化 `updateItemStatus` 方法** (第40-49行):
   - 移除基于金币数量的按钮置灰逻辑
   - 所有按钮保持可用状态

**道具映射**:
- itemBtn1: 豪华礼包 (横向+同色+炸弹道具各1个)
- itemBtn2: 1000金币
- itemBtn3: 5000金币  
- itemBtn4: 炸弹道具 x1
- itemBtn5: 横向消除道具 x1
- itemBtn6: 同色消除道具 x1
- itemBtn7: 爱心 x1

## 用户体验改进

### 游戏内道具加号按钮
1. 点击任意道具的"+"按钮
2. 显示"观看广告获取XX道具"提示
3. 观看15秒激励视频
4. 获得对应道具并显示成功提示

### 商店页面
1. 所有商品按钮都保持可点击状态
2. 点击任意商品按钮触发广告观看
3. 不再需要检查金币数量
4. 支持获取道具和金币两种类型奖励

## 技术实现细节

### 广告回调机制
```typescript
Advertise.showVideoAds((success: boolean) => {
    if (success) {
        // 广告观看完成的奖励逻辑
        GlobalFuncHelper.setBomb(type, 1);
        App.event.emit(EventName.Game.ToolCountRefresh);
        App.view.showMsgTips("获得奖励！");
    }
    // 如果success为false，表示用户跳过广告，不给予奖励
});
```

### 事件刷新
- 使用 `EventName.Game.ToolCountRefresh` 刷新道具数量显示
- 使用 `EventName.Game.UpdataGold` 刷新金币显示（仅获取金币时）

## 业务逻辑优化

### 移除的功能
- ❌ 金币充足性检查
- ❌ 金币扣费逻辑  
- ❌ 基于金币的按钮置灰
- ❌ 购买成功/失败的复杂逻辑

### 新增的功能
- ✅ 统一的广告观看流程
- ✅ 一致的奖励发放机制
- ✅ 更好的用户提示体验
- ✅ 简化的UI状态管理

## 收益模式转变

**原模式**: 用户消费金币购买道具
**新模式**: 用户观看广告获得道具

**优势**:
1. 提升广告收益（每个道具获取都需要看广告）
2. 减少用户付费压力
3. 增加用户留存（免费获取道具）
4. 简化游戏内经济系统

## 完全覆盖的获取途径

现在游戏中所有道具获取都统一为观看广告：
1. 游戏内道具不足时点击"+"按钮 → 看广告
2. 商店页面购买道具 → 看广告  
3. 商店页面获取金币 → 看广告
4. 游戏失败后继续游戏 → 看广告
5. 获取额外步数 → 看广告

所有获取途径都统一使用15秒激励视频广告，确保一致的用户体验和广告收益。